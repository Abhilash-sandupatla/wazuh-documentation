.. Copyright (C) 2021 Wazuh, Inc.

.. _integrating-aws-cloudwatch-logs:

Integrating AWS CloudWatch Logs in Wazuh
========================================

The AWS CloudWatch Logs integration was added with the Wazuh 4.0 release and below we will focus on setting up Wazuh to collect log files from Amazon EC2 and Fargate instances, AWS CloudTrail, and many other sources supported by CloudWatch Logs.

What is AWS CloudWatch Logs
---------------------------

CloudWatch Logs acts as a central log management service that stores the logs from all the systems, applications, and AWS services. It allows users to see all the logs, regardless of their source, as a single and consistent flow of events ordered by time.

To understand how CloudWatch Logs works it is necessary to learn about the following concepts and how they are related:

- **Log events**: CloudWatch saves the logs generated by the application or resource being monitored as log events. A log event is a record with two properties: the timestamp when the event occurred and the raw log message.
- **Log streams**: Log events are stored in log streams. A log stream represents a sequence of events coming from the application instance or resource being monitored. All log events in a log stream share the same source.
- **Log groups**: Log streams are grouped using log groups. A log group defines a group of log streams that shares retention, monitoring, and access control settings.
  

How the Wazuh integration works
-------------------------------

The Wazuh CloudWatch Logs integration establishes a connection with CloudWatch using the AWS API and the credentials provided by the user. It will periodically pull the logs contained in the specified log group and send them to the Analysisd component, which will generate an alert if the log message matches with an applicable rule.

Setting it up
-------------

The following diagram shows what we want to accomplish:

    .. thumbnail:: /images/aws/cloudwatch-diagram.png
      :align: center
      :width: 70%

