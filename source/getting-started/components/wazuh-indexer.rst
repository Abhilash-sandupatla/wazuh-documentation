.. Copyright (C) 2021 Wazuh, Inc.

.. _wazuh_indexer:

[WIP] Wazuh indexer
===================

The Wazuh indexer is highly scalable, full-text search and analytics engine. The Wazuh indexer is distributed, meaning the data indices are divided into shards and each shard can have zero or more replicas. Wazuh uses different indices for alerts data, raw events, and status monitoring information.


A Wazuh index is a collection of documents that have somewhat similar characteristics (like certain common fields and shared data retention requirements). Wazuh utilizes as many as three different indices, created daily, to store different event types:

- **wazuh-alerts:** Index for alerts generated by the :ref:`Wazuh server <wazuh_server>`. Those are created each time an event trips a rule with a high enough priority (this threshold is configurable).

- **wazuh-archives:** Index for all events (archive data) received from the agents, whether or not they trip a rule.

- **wazuh-monitoring:** Index for data related to the :ref:`Wazuh agents <wazuh_agent>` status over time. It is used by the web interface to represent when individual agents are or have been ``Active``, ``Disconnected``, or ``Never connected``.

An index is composed of documents. For the indices above, documents are individual alerts, archived events, or the Wazuh agents status-related data.

A Wazuh index is divided into one or more shards, and each shard can optionally have one or more replicas. Each primary and replica shard is an individual Lucene index. Thus, a Wazuh index is made up of many Lucene indexes. When a search is run on a Wazuh index, the search is executed on all the shards in parallel and the results are merged. Dividing Wazuh indexes into multiple shards and replicas is used in multi-node Wazuh indexer clusters, with the purpose of scaling out searches and for high availability. Single-node Wazuh indexer clusters normally have only one shard per index and no replicas.