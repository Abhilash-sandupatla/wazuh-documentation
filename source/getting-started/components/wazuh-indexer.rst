.. Copyright (C) 2021 Wazuh, Inc.

.. _wazuh_indexer:

[WIP] Wazuh indexer
===================

The Wazuh indexer is a highly scalable, full-text search and analytics engine. The component is distributed, meaning the data indices are divided into shards and each shard can have zero or more replicas. Wazuh uses different indices for alerts data, raw events, and status monitoring information.

A Wazuh index is a collection of documents that have somewhat similar characteristics, like certain common fields and shared data retention requirements. Wazuh utilizes as many as four different indices to store different event types.

.. |--| unicode:: U+02011 .. non-breaking dash
   :trim:

+---------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+ 
| Index                           | Description                                                                                                                                                                                                                    |
+=================================+================================================================================================================================================================================================================================+
| **wazuh** |--| **alerts**       | Stores alerts generated by the :ref:`Wazuh server <wazuh_server>`. These are created each time an event trips a rule with a high enough priority (this threshold is configurable).                                             |
+---------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+ 
| **wazuh** |--| **archives**     | Stores all events (archive data) received from the agents, whether or not they trip a rule.                                                                                                                                    |
+---------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+ 
| **wazuh** |--| **monitoring**   | Stores data related to the :ref:`Wazuh agents <wazuh_agent>` status over time. It is used by the web interface to represent when individual agents are or have been ``Active``, ``Disconnected``, or ``Never connected``.      |
+---------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+ 
| **wazuh** |--| **statistics**   | Stores data related to the Wazuh manager performance. It is used by the web interface to represent the daemons statistics.                                                                                                     |
+---------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+ 


An index is composed of documents. For the indices above, documents are individual alerts, archived events, the Wazuh agents status-related data or the Wazuh manager performance-related data.

A Wazuh index is divided into one or more shards, and each shard can optionally have one or more replicas. Each primary and replica shard is an individual Lucene index. Thus, a Wazuh index is made up of many Lucene indexes. When a search is run on a Wazuh index, the search is executed on all the shards in parallel and the results are merged. Dividing Wazuh indexes into multiple shards and replicas is used in multi-node Wazuh indexer clusters, with the purpose of scaling out searches and for high availability. Single-node Wazuh indexer clusters normally have only one shard per index and no replicas.

You interact with the Wazuh indexer clusters using the REST API, which offers a lot of flexibility. You can perform searches, add or delete documents, modify indices, among others. 